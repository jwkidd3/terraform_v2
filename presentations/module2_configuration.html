<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2: Mastering Terraform Configuration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/theme/white.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/monokai.min.css">
    <style>
        /* Terraform Brand Colors */
        :root {
            --terraform-purple: #623ce4;
            --terraform-dark: #1e1e3f;
            --terraform-light: #f5f5ff;
            --accent-blue: #1e88e5;
            --accent-green: #4caf50;
            --accent-orange: #ff9800;
            --accent-red: #f44336;
        }

        /* Global Reveal.js Overrides */
        .reveal {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: 30px;
            font-weight: 300;
            color: #2c3e50;
        }

        .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
            color: var(--terraform-purple);
            font-weight: 600;
            text-transform: none;
            line-height: 1.2;
        }

        .reveal h1 {
            font-size: 1.6em;
            text-shadow: 2px 2px 4px rgba(98, 60, 228, 0.3);
            margin-bottom: 0.2em;
        }

        .reveal h2 {
            font-size: 1.25em;
            margin-bottom: 0.2em;
        }

        .reveal h3 {
            font-size: 1.0em;
            margin-bottom: 0.1em;
        }

        .reveal h4 {
            font-size: 0.9em;
            color: var(--terraform-dark);
            margin-bottom: 0.1em;
        }

        /* Slide Layout */
        .reveal .slides section {
            text-align: left;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 12px;
            box-sizing: border-box;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: 100vh;
        }

        .reveal .title-slide {
            text-align: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--terraform-light) 0%, #e8e4ff 100%);
            color: var(--terraform-dark);
        }

        /* Typography */
        .reveal p {
            margin: 0.4em 0;
            line-height: 1.4;
            font-size: 0.9em;
        }

        .reveal ul, .reveal ol {
            margin: 0.2em 0 0.2em 0.5em;
            line-height: 1.2;
            font-size: 0.75em;
        }

        .reveal li {
            margin: 0.1em 0;
        }

        /* Code Styling */
        .reveal code {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 4px 8px;
            color: var(--terraform-dark);
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }

        .reveal pre {
            background-color: #1e1e1e;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 1em 0;
            max-width: 100%;
            overflow: hidden;
        }

        .reveal pre code {
            background-color: transparent;
            border: none;
            padding: 8px;
            font-size: 0.55em;
            line-height: 1.15;
            color: #f8f8f2;
            max-height: 300px;
            overflow-y: auto;
            display: block;
            word-wrap: break-word;
            scrollbar-width: thin;
            scrollbar-color: var(--terraform-purple) rgba(255,255,255,0.1);
        }

        /* Layout Components */
        .reveal .two-column {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            margin: 1em 0;
        }

        .reveal .three-column {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            margin: 1em 0;
        }

        .reveal .column {
            flex: 1;
            padding: 0;
            min-width: 0;
        }

        .reveal .column h4 {
            margin-top: 0;
            border-bottom: 2px solid var(--terraform-purple);
            padding-bottom: 0.3em;
        }

        /* Alert Boxes */
        .reveal .highlight {
            background: linear-gradient(90deg, #fff3cd 0%, #fef7d9 100%);
            border-left: 4px solid var(--accent-orange);
            border-radius: 0 6px 6px 0;
            padding: 8px 12px;
            margin: 8px 0;
            box-shadow: 0 1px 3px rgba(255, 152, 0, 0.2);
            font-size: 0.75em;
        }

        .reveal .danger {
            background: linear-gradient(90deg, #f8d7da 0%, #fce4e6 100%);
            border-left: 4px solid var(--accent-red);
            border-radius: 0 6px 6px 0;
            padding: 8px 12px;
            margin: 8px 0;
            box-shadow: 0 1px 3px rgba(244, 67, 54, 0.2);
            font-size: 0.75em;
        }

        .reveal .success {
            background: linear-gradient(90deg, #d1ecf1 0%, #ddf2f7 100%);
            border-left: 4px solid var(--accent-blue);
            border-radius: 0 6px 6px 0;
            padding: 8px 12px;
            margin: 8px 0;
            box-shadow: 0 1px 3px rgba(30, 136, 229, 0.2);
            font-size: 0.75em;
        }

        .reveal .info {
            background: linear-gradient(90deg, #d4edda 0%, #e2f5e7 100%);
            border-left: 4px solid var(--accent-green);
            border-radius: 0 6px 6px 0;
            padding: 8px 12px;
            margin: 8px 0;
            box-shadow: 0 1px 3px rgba(76, 175, 80, 0.2);
            font-size: 0.75em;
        }

        .reveal .terraform-brand {
            background: linear-gradient(135deg, var(--terraform-purple) 0%, #7c4dff 100%);
            border-radius: 6px;
            padding: 8px 10px;
            margin: 6px 0;
            color: white;
            font-size: 0.75em;
        }

        /* Lab Callout Optimization */
        .reveal .lab-callout {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            overflow: auto;
            padding: 8px;
        }
        
        .reveal .lab-callout h1 {
            font-size: 1.3em;
            margin-bottom: 0.1em;
            line-height: 1.2;
        }
        
        .reveal .lab-callout h2 {
            font-size: 1.0em;
            margin-bottom: 0.1em;
            line-height: 1.2;
        }
        
        .reveal .lab-callout h3 {
            font-size: 0.9em;
            margin-bottom: 0.1em;
            line-height: 1.2;
        }
        
        .reveal .lab-callout ul {
            font-size: 0.7em;
            line-height: 1.2;
            margin: 0.2em 0;
        }
        
        .reveal .lab-callout li {
            margin: 0.1em 0;
        }
        
        .reveal .lab-callout > div {
            padding: 8px;
            max-width: 95%;
        }
        
        .reveal .lab-callout p {
            margin: 0.2em 0;
            font-size: 0.85em;
        }
        
        /* Enhanced responsive design for lab callouts */
        @media screen and (max-width: 1024px) {
            .reveal .lab-callout h1 {
                font-size: 1.2em;
            }
            
            .reveal .lab-callout h2 {
                font-size: 0.95em;
            }
            
            .reveal .lab-callout ul {
                font-size: 0.65em;
            }
        }
        
        @media screen and (max-width: 768px) {
            .reveal .lab-callout h1 {
                font-size: 1.1em;
            }
            
            .reveal .lab-callout h2 {
                font-size: 0.9em;
            }
            
            .reveal .lab-callout ul {
                font-size: 0.6em;
            }
        }

        /* Section Dividers */
        .reveal .section-divider {
            background: linear-gradient(90deg, var(--terraform-purple) 0%, #7c4dff 100%);
            color: white;
            text-align: center;
            padding: 40px 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .reveal .section-divider h2 {
            color: white;
            margin: 0;
            font-size: 2.5em;
        }

        /* Tables */
        .reveal table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
        }

        .reveal table th,
        .reveal table td {
            border: 1px solid #ddd;
            padding: 12px 16px;
            text-align: left;
        }

        .reveal table th {
            background-color: var(--terraform-purple);
            color: white;
            font-weight: 600;
        }

        .reveal table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* Lists */
        .reveal .checklist li::marker {
            content: "‚úÖ ";
        }

        .reveal .warning-list li::marker {
            content: "‚ö†Ô∏è ";
        }

        .reveal .feature-list li::marker {
            content: "üöÄ ";
        }

        /* Buttons/Links */
        .reveal .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--terraform-purple);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            margin: 10px 10px 10px 0;
            transition: all 0.3s ease;
        }

        .reveal .btn:hover {
            background-color: var(--terraform-dark);
            transform: translateY(-2px);
        }

        /* Progress Indicators */
        .reveal .progress-bar {
            background-color: #e9ecef;
            border-radius: 4px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .reveal .progress-fill {
            background: linear-gradient(90deg, var(--terraform-purple) 0%, #7c4dff 100%);
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Enhanced Responsive Design for Better Screen Fit */
        @media screen and (min-width: 1600px) {
            .reveal {
                font-size: 32px;
            }
        }

        @media screen and (max-width: 1400px) {
            .reveal {
                font-size: 28px;
            }
            
            .reveal table {
                font-size: 0.65em;
            }
            
            .reveal ul, .reveal ol {
                font-size: 0.7em;
            }
        }

        @media screen and (max-width: 1024px) {
            .reveal {
                font-size: 24px;
            }
            
            .reveal .two-column,
            .reveal .three-column {
                flex-direction: column;
                gap: 12px;
            }
            
            .reveal pre code {
                font-size: 0.5em;
                max-height: 280px;
            }
            
            .reveal .slides section {
                padding: 8px;
            }
            
            .reveal table {
                font-size: 0.6em;
            }
            
            .reveal ul, .reveal ol {
                font-size: 0.65em;
            }
        }

        @media screen and (max-width: 768px) {
            .reveal .two-column,
            .reveal .three-column {
                flex-direction: column;
                gap: 10px;
            }
            
            .reveal {
                font-size: 22px;
            }
            
            .reveal h1 {
                font-size: 1.7em;
            }
            
            .reveal h2 {
                font-size: 1.4em;
            }
            
            .reveal h3 {
                font-size: 1.1em;
            }
            
            .reveal pre code {
                font-size: 0.45em;
                max-height: 250px;
                padding: 8px;
            }
            
            .reveal .slides section {
                padding: 6px;
            }
            
            .reveal table {
                font-size: 0.55em;
            }
            
            .reveal ul, .reveal ol {
                font-size: 0.6em;
            }
            
            .reveal .highlight, .reveal .danger, .reveal .success, .reveal .info {
                padding: 6px 8px;
                font-size: 0.7em;
            }
        }

        /* Content overflow prevention */
        .reveal section {
            overflow-x: auto;
            overflow-y: auto;
        }
        
        .reveal pre {
            max-width: 100%;
            overflow-x: auto;
        }
        
        .reveal table {
            font-size: 0.7em;
            overflow-x: auto;
            display: block;
            white-space: nowrap;
            width: 100%;
            border-collapse: collapse;
        }
        
        .reveal table th, .reveal table td {
            padding: 4px 6px;
            border: 1px solid #ddd;
            font-size: inherit;
        }

        /* Custom Components */
        .reveal .terraform-logo {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: var(--terraform-purple);
            border-radius: 6px;
            margin-right: 12px;
            vertical-align: middle;
        }

        .reveal .code-block-title {
            background-color: var(--terraform-dark);
            color: white;
            padding: 8px 16px;
            margin: 20px 0 0 0;
            border-radius: 6px 6px 0 0;
            font-size: 0.8em;
            font-weight: 600;
        }

        .reveal .code-block-title + pre {
            margin-top: 0;
            border-radius: 0 0 8px 8px;
        }

        /* Animation Classes */
        .reveal .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Speaker Notes */
        .reveal .notes {
            font-size: 0.7em;
            color: #666;
            font-style: italic;
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- Title Slide -->
            <section class="title-slide">
                <div class="terraform-logo"></div>
                <h1>Module 2: Mastering Terraform Configuration</h1>
                <h2>Advanced Configuration Management & Enterprise Best Practices</h2>
                <div class="progress-bar" style="width: 300px; margin: 30px auto;">
                    <div class="progress-fill" style="width: 67%;"></div>
                </div>
                <p><strong>Course Structure:</strong> Day 2 of 3</p>
                <p><strong>Focus:</strong> Advanced Configuration Management</p>
                <p><strong>üìä 70% Hands-on | 30% Theory</strong></p>
                <div class="terraform-brand" style="margin: 20px auto; max-width: 600px;">
                    <p>üéØ <strong>Focus:</strong> Advanced Terraform patterns, modules, and production-ready configurations</p>
                </div>
            </section>

            <!-- Day 2 Complete Schedule Overview -->
            <section class="dense-content">
                <div class="section-divider">
                    <h2>üóìÔ∏è Day 2: Complete Schedule & Learning Journey</h2>
                </div>
                <div class="terraform-brand">
                    <h3>üìä Advanced Configuration Management Mastery - 7 Hours Total</h3>
                    <p><strong>70% Hands-on (5 hours labs) | 30% Theory (2 hours presentations)</strong></p>
                </div>
                <div class="enterprise">
                    <h4>üèÜ Day 2 Career Impact</h4>
                    <p><strong>Enterprise Readiness:</strong> Advance from foundational Terraform knowledge to advanced configuration management patterns used by Fortune 500 companies. Master state management, module composition, and multi-environment strategies essential for DevOps Engineer, Cloud Architect, and Platform Engineering roles.</p>
                </div>
            </section>

            <!-- Detailed Learning Objectives -->
            <section class="dense-content">
                <div class="section-divider">
                    <h2>üéØ Comprehensive Learning Objectives & Outcomes</h2>
                </div>
                <div class="terraform-brand">
                    <h3>üöÄ Advanced Configuration Mastery - What You'll Achieve</h3>
                    <p>Transform from Terraform fundamentals to enterprise configuration expert with production-ready patterns and industry best practices</p>
                </div>
                <div class="two-column">
                    <div class="column">
                        <h4>üîß Core Technical Competencies</h4>
                        <ul style="font-size: 0.8em; line-height: 1.3;">
                            <li><strong>Advanced Variable Patterns:</strong> Complex type validation, nested objects, conditional logic with 15+ validation rules</li>
                            <li><strong>Dynamic Configuration:</strong> Locals, functions, conditionals, dynamic blocks with real-world scenarios</li>
                            <li><strong>Resource Lifecycle Mastery:</strong> prevent_destroy, create_before_destroy, ignore_changes, replace_triggered_by</li>
                            <li><strong>Data Integration:</strong> Remote state consumption, data source optimization, cross-stack references</li>
                            <li><strong>Module Architecture:</strong> Reusable components, version management, composition patterns</li>
                            <li><strong>State Management:</strong> Remote backends, locking, workspace strategies, migration techniques</li>
                            <li><strong>Dependency Orchestration:</strong> Implicit vs explicit dependencies, complex resource graphs</li>
                            <li><strong>Multi-Environment Patterns:</strong> Workspace strategies, environment-specific configurations</li>
                        </ul>
                    </div>
                    <div class="column">
                        <h4>üíº Professional & Enterprise Skills</h4>
                        <ul style="font-size: 0.8em; line-height: 1.3;">
                            <li><strong>Production Debugging:</strong> TF_LOG, state inspection, resource targeting, advanced troubleshooting</li>
                            <li><strong>Code Organization:</strong> Directory structure, naming conventions, file organization best practices</li>
                            <li><strong>Security Implementation:</strong> Sensitive variables, secrets management, encryption patterns</li>
                            <li><strong>Team Collaboration:</strong> Shared state, code reviews, module sharing, documentation standards</li>
                            <li><strong>Enterprise Patterns:</strong> Resource tagging, compliance frameworks, governance models</li>
                            <li><strong>Performance Optimization:</strong> Resource targeting, parallelization, state file optimization</li>
                            <li><strong>Error Prevention:</strong> Validation rules, preconditions, postconditions, testing patterns</li>
                            <li><strong>Version Management:</strong> Provider constraints, module versioning, upgrade strategies</li>
                        </ul>
                    </div>
                </div>
                <div class="three-column" style="margin-top: 20px;">
                    <div class="column">
                        <div class="info">
                            <h4>üß™ Lab 6: Remote State</h4>
                            <ul style="font-size: 0.75em;">
                                <li>S3 + DynamoDB backend setup</li>
                                <li>State locking & encryption</li>
                                <li>Migration from local state</li>
                                <li>Lifecycle policies & cost optimization</li>
                            </ul>
                        </div>
                    </div>
                    <div class="column">
                        <div class="success">
                            <h4>üß™ Lab 7: Registry Modules</h4>
                            <ul style="font-size: 0.75em;">
                                <li>6+ module integration</li>
                                <li>VPC, ALB, RDS, S3 modules</li>
                                <li>KMS encryption & Parameter Store</li>
                                <li>Enterprise patterns & best practices</li>
                            </ul>
                        </div>
                    </div>
                    <div class="column">
                        <div class="highlight">
                            <h4>üß™ Labs 8-9: Advanced Patterns</h4>
                            <ul style="font-size: 0.75em;">
                                <li>Multi-environment management</li>
                                <li>Complex variable structures</li>
                                <li>Production networking architecture</li>
                                <li>Security & compliance validation</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="enterprise" style="margin-top: 15px;">
                    <h4>üìà Industry Impact & Career Advancement</h4>
                    <p><strong>Market Differentiation:</strong> These advanced configuration patterns are used by 95% of Fortune 500 companies. Master skills directly applicable to <strong>DevOps Engineer ($95k-$150k)</strong>, <strong>Cloud Architect ($120k-$180k)</strong>, and <strong>Platform Engineer ($110k-$160k)</strong> positions. Gain expertise in enterprise patterns that separate senior practitioners from junior users.</p>
                </div>
            </section>

            <!-- Lab Overview & Outcomes Matrix -->
            <section class="dense-content">
                <div class="section-divider">
                    <h2>üß™ Day 2 Laboratory Exercises - Detailed Overview</h2>
                </div>
                <div class="terraform-brand">
                    <h3>üìä Four Comprehensive Labs - 3 Hours Total Hands-on Experience</h3>
                    <p>Each lab builds on the previous, creating a comprehensive enterprise-ready infrastructure management skillset</p>
                </div>
                
                <!-- Labs 6-7 Details -->
                <div class="two-column">
                    <div class="column">
                        <div class="info" style="padding: 15px;">
                            <h4>üóÑÔ∏è Lab 6: Remote State Management (45 min)</h4>
                            <p style="font-size: 0.8em; margin: 5px 0;"><strong>Focus:</strong> Production-ready state backend implementation</p>
                            <ul style="font-size: 0.75em; line-height: 1.2; margin: 10px 0;">
                                <li><strong>S3 Backend:</strong> Encrypted bucket with versioning, lifecycle policies</li>
                                <li><strong>DynamoDB Locking:</strong> Prevent concurrent modifications</li>
                                <li><strong>State Migration:</strong> Move from local to remote with validation</li>
                                <li><strong>Security:</strong> KMS encryption, IAM policies, bucket policies</li>
                                <li><strong>Cost Optimization:</strong> Lifecycle rules, intelligent tiering</li>
                                <li><strong>Monitoring:</strong> CloudWatch metrics, SNS notifications</li>
                            </ul>
                            <div style="background: rgba(30, 136, 229, 0.1); padding: 8px; border-radius: 4px; margin-top: 10px;">
                                <p style="font-size: 0.7em; margin: 0;"><strong>Outcomes:</strong> Master team collaboration state patterns used by 90% of enterprise Terraform implementations</p>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="success" style="padding: 15px;">
                            <h4>üîß Lab 7: Terraform Registry Modules (45 min)</h4>
                            <p style="font-size: 0.8em; margin: 5px 0;"><strong>Focus:</strong> Enterprise registry modules & production patterns</p>
                            <ul style="font-size: 0.75em; line-height: 1.2; margin: 10px 0;">
                                <li><strong>Enterprise Registry Modules:</strong> VPC, Security, Database, Load Balancing</li>
                                <li><strong>Cross-Module Dependencies:</strong> Output consumption, data passing</li>
                                <li><strong>Secrets Management:</strong> Parameter Store, KMS encryption</li>
                                <li><strong>Production Patterns:</strong> Blue/green ready, high availability</li>
                                <li><strong>Monitoring Integration:</strong> CloudWatch, SNS, dashboards</li>
                                <li><strong>Cost Tags:</strong> Comprehensive resource tagging strategy</li>
                            </ul>
                            <div style="background: rgba(30, 136, 229, 0.1); padding: 8px; border-radius: 4px; margin-top: 10px;">
                                <p style="font-size: 0.7em; margin: 0;"><strong>Outcomes:</strong> Build enterprise-grade multi-tier architectures with professional module composition</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Labs 8-9 Details -->
                <div class="two-column" style="margin-top: 15px;">
                    <div class="column">
                        <div class="highlight" style="padding: 15px;">
                            <h4>üåç Lab 8: Multi-Environment Patterns (45 min)</h4>
                            <p style="font-size: 0.8em; margin: 5px 0;"><strong>Focus:</strong> Sophisticated environment management strategies</p>
                            <ul style="font-size: 0.75em; line-height: 1.2; margin: 10px 0;">
                                <li><strong>Environment Variables:</strong> Complex nested objects with validation</li>
                                <li><strong>Feature Flags:</strong> Environment-specific feature enablement</li>
                                <li><strong>Cost Optimization:</strong> Per-environment budget controls</li>
                                <li><strong>Compliance Levels:</strong> Environment-specific security policies</li>
                                <li><strong>Validation Scripts:</strong> Automated environment verification</li>
                                <li><strong>Resource Scaling:</strong> Dynamic sizing based on environment</li>
                            </ul>
                            <div style="background: rgba(255, 152, 0, 0.1); padding: 8px; border-radius: 4px; margin-top: 10px;">
                                <p style="font-size: 0.7em; margin: 0;"><strong>Outcomes:</strong> Master environment management patterns for development ‚Üí staging ‚Üí production workflows</p>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="enterprise" style="padding: 15px;">
                            <h4>üåê Lab 9: VPC Multi-Tier Architecture (45 min)</h4>
                            <p style="font-size: 0.8em; margin: 5px 0;"><strong>Focus:</strong> Production networking & security architecture</p>
                            <ul style="font-size: 0.75em; line-height: 1.2; margin: 10px 0;">
                                <li><strong>Multi-AZ VPC:</strong> Public, private, database subnets</li>
                                <li><strong>Application Load Balancer:</strong> Multi-target, health checks</li>
                                <li><strong>Security Groups:</strong> Layered security, least privilege</li>
                                <li><strong>NAT Gateways:</strong> High availability, cost optimization</li>
                                <li><strong>Route Tables:</strong> Complex routing, security zones</li>
                                <li><strong>Network ACLs:</strong> Additional security layer implementation</li>
                            </ul>
                            <div style="background: rgba(98, 60, 228, 0.1); padding: 8px; border-radius: 4px; margin-top: 10px;">
                                <p style="font-size: 0.7em; margin: 0;"><strong>Outcomes:</strong> Design enterprise networking architectures with security best practices and high availability</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="danger" style="margin-top: 15px; padding: 15px;">
                    <h4>üéØ Progressive Complexity & Skills Building</h4>
                    <div class="two-column" style="margin-top: 10px;">
                        <div class="column">
                            <p style="font-size: 0.8em; margin: 0;"><strong>Skill Progression:</strong> Each lab increases in complexity:</p>
                            <ul style="font-size: 0.75em; margin: 8px 0;">
                                <li><strong>Lab 6:</strong> Foundation - Enterprise state management</li>
                                <li><strong>Lab 7:</strong> Integration - Registry module composition</li>
                                <li><strong>Lab 8:</strong> Sophistication - Multi-environment patterns</li>
                                <li><strong>Lab 9:</strong> Mastery - Enterprise networking architecture</li>
                            </ul>
                        </div>
                        <div class="column">
                            <p style="font-size: 0.8em; margin: 0;"><strong>Real-World Application:</strong></p>
                            <ul style="font-size: 0.75em; margin: 8px 0;">
                                <li>Patterns used by Netflix, Spotify, Airbnb</li>
                                <li>Fortune 500 enterprise standards</li>
                                <li>Cloud migration best practices</li>
                                <li>Production incident prevention strategies</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 1: Advanced Variables and Outputs -->
            <section>
                <section class="section-divider">
                    <h2>üîß Section 1: Advanced Variables & Outputs</h2>
                    <p>Master complex data structures and validation patterns</p>
                </section>

                <section>
                    <h3>üèóÔ∏è Advanced Variable Patterns</h3>
                    <div class="info">
                        <p><strong>Enterprise Reality:</strong> Modern infrastructure requires complex, validated configurations that scale across multiple environments and teams.</p>
                    </div>
                    <h4>üîç Complex Type Validation</h4>
                    <div class="code-block-title">Environment Configuration with Advanced Validation</div>
                    <pre><code class="language-hcl">variable "environments" {
  description = "Multi-environment infrastructure configuration"
  type = map(object({
    # Compute Configuration
    instance_type    = string
    min_size        = number
    max_size        = number
    
    # Feature Flags
    enable_logging  = bool
    enable_backup   = bool
    enable_monitoring = bool
    
    # Security Configuration
    allowed_cidrs   = list(string)
    security_groups = list(string)
    
    # Cost Control
    max_monthly_cost = number
  }))
  
  validation {
    condition = alltrue([
      for env, config in var.environments :
      can(regex("^t[2-4]\\.(nano|micro|small|medium)", config.instance_type))
    ])
    error_message = "Instance types must be cost-effective t2, t3, or t4 family (nano through medium)."
  }
  
  validation {
    condition = alltrue([
      for env, config in var.environments :
      config.min_size <= config.max_size && config.max_size <= 10
    ])
    error_message = "Min size must be <= max size, and max size must be <= 10 for cost control."
  }
  
  validation {
    condition = alltrue([
      for env, config in var.environments :
      config.max_monthly_cost > 0 && config.max_monthly_cost <= 10000
    ])
    error_message = "Monthly cost limit must be between $1 and $10,000."
  }
}</code></pre>
                    <div class="highlight">
                        <p><strong>üí° Pro Tip:</strong> Layer multiple validation rules to catch different types of configuration errors early in the development cycle.</p>
                    </div>
                </section>

                <section>
                    <h3>‚ö° Dynamic Configuration with Locals</h3>
                    <div class="terraform-brand">
                        <p><strong>Enterprise Pattern:</strong> Use locals to create computed values that adapt to different environments while maintaining consistency.</p>
                    </div>
                    <div class="code-block-title">Advanced Locals Configuration</div>
                    <pre><code class="language-hcl">locals {
  # Environment-specific configuration
  env_config = var.environments[var.current_environment]
  current_timestamp = formatdate("YYYY-MM-DD-hhmm", timestamp())
  
  # Computed naming patterns
  resource_prefix = "${var.organization}-${var.project_name}-${var.current_environment}"
  instance_name = "${local.resource_prefix}-web"
  
  # Conditional logic for different environments
  monitoring_enabled = var.current_environment == "production" ? true : local.env_config.enable_monitoring
  backup_enabled = contains(["production", "staging"], var.current_environment)
  encryption_enabled = var.current_environment != "development"
  
  # Complex data transformations
  subnets_by_az = {
    for subnet in var.private_subnets :
    subnet.availability_zone => {
      id         = subnet.id
      cidr_block = subnet.cidr_block
      tier       = subnet.tier
    }
  }
  
  # Availability zone distribution
  az_distribution = {
    for i, az in data.aws_availability_zones.available.names :
    az => {
      private_subnet = cidrsubnet(var.vpc_cidr, 8, i + 10)
      public_subnet  = cidrsubnet(var.vpc_cidr, 8, i + 20)
    }
  }
  
  # Comprehensive tagging strategy
  common_tags = merge(var.default_tags, {
    Environment     = var.current_environment
    Project         = var.project_name
    Organization    = var.organization
    ManagedBy      = "Terraform"
    DeployedAt     = local.current_timestamp
    CostCenter     = local.env_config.cost_center
    Owner          = local.env_config.owner_email
    BackupEnabled  = tostring(local.backup_enabled)
    MonitoringTier = local.monitoring_enabled ? "enhanced" : "basic"
  })
  
  # Security group rules generation
  ingress_rules = {
    for rule in var.security_rules :
    "${rule.name}-${rule.port}" => {
      from_port   = rule.port
      to_port     = rule.port
      protocol    = rule.protocol
      cidr_blocks = rule.environment == "all" ? ["0.0.0.0/0"] : local.env_config.allowed_cidrs
      description = "${rule.description} for ${var.current_environment}"
    }
  }
}</code></pre>
                    <div class="success">
                        <p><strong>üéØ Best Practice:</strong> Use locals to eliminate code duplication and create single sources of truth for computed values.</p>
                    </div>
                </section>

                <section>
                    <h3>üìä Advanced Output Patterns</h3>
                    <div class="info">
                        <p><strong>Module Integration:</strong> Well-structured outputs are crucial for module composition and cross-stack references in enterprise architectures.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>üèóÔ∏è Structured Module Outputs</h4>
                            <div class="code-block-title">networking-outputs.tf</div>
                            <pre><code class="language-hcl"># Hierarchical output structure
output "networking" {
  description = "Complete networking configuration"
  value = {
    # Core Infrastructure
    vpc = {
      id         = aws_vpc.main.id
      cidr_block = aws_vpc.main.cidr_block
      arn        = aws_vpc.main.arn
    }
    
    # Subnet Information
    subnets = {
      private = {
        ids          = aws_subnet.private[*].id
        cidr_blocks  = aws_subnet.private[*].cidr_block
        azs          = aws_subnet.private[*].availability_zone
      }
      public = {
        ids          = aws_subnet.public[*].id
        cidr_blocks  = aws_subnet.public[*].cidr_block
        azs          = aws_subnet.public[*].availability_zone
      }
    }
    
    # Gateway Configuration
    gateways = {
      internet = aws_internet_gateway.main.id
      nat      = aws_nat_gateway.main[*].public_ip
    }
    
    # Route Tables
    route_tables = {
      private_ids = aws_route_table.private[*].id
      public_id   = aws_route_table.public.id
    }
  }
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üîí Sensitive Data Handling</h4>
                            <div class="code-block-title">security-outputs.tf</div>
                            <pre><code class="language-hcl"># Sensitive outputs with proper marking
output "database_connection" {
  description = "RDS connection details"
  value = {
    # Non-sensitive connection info
    endpoint         = aws_rds_instance.main.endpoint
    port            = aws_rds_instance.main.port
    database_name   = aws_rds_instance.main.db_name
    
    # Sensitive authentication info
    credentials = {
      username = aws_rds_instance.main.username
      password = aws_rds_instance.main.password
    }
    
    # Connection string template
    connection_template = "postgresql://${aws_rds_instance.main.username}:[PASSWORD]@${aws_rds_instance.main.endpoint}:${aws_rds_instance.main.port}/${aws_rds_instance.main.db_name}"
  }
  sensitive = true
}

# Conditional outputs
output "monitoring_endpoints" {
  description = "Monitoring service endpoints"
  value = local.monitoring_enabled ? {
    cloudwatch_log_group = aws_cloudwatch_log_group.app[0].name
    sns_topic_arn       = aws_sns_topic.alerts[0].arn
  } : null
}</code></pre>
                        </div>
                    </div>
                    <div class="danger">
                        <h4>‚ö†Ô∏è Security Warning</h4>
                        <p>Always mark outputs containing passwords, keys, or tokens as <code>sensitive = true</code>. This prevents them from appearing in logs and console output.</p>
                    </div>
                </section>

                <section>
                    <h3>üìà Variable Precedence & Source Management</h3>
                    <div class="terraform-brand">
                        <p><strong>Enterprise Challenge:</strong> Managing variables across multiple environments, teams, and deployment pipelines requires understanding precedence and source strategies.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <div class="highlight">
                                <h4>üîç Precedence Order (Highest ‚Üí Lowest)</h4>
                                <ol>
                                    <li><strong>CLI `-var` flags</strong> (Override everything)</li>
                                    <li><strong>CLI `-var-file`</strong> (Deployment-specific)</li>
                                    <li><strong>Environment variables</strong> <code>TF_VAR_*</code></li>
                                    <li><strong>terraform.tfvars</strong> (Main config)</li>
                                    <li><strong>*.auto.tfvars</strong> (Auto-loaded, alphabetical)</li>
                                    <li><strong>Variable defaults</strong> (Fallback values)</li>
                                </ol>
                            </div>
                            <div class="info">
                                <h4>üéØ Strategic Usage</h4>
                                <ul>
                                    <li><strong>Defaults:</strong> Safe fallbacks</li>
                                    <li><strong>*.auto.tfvars:</strong> Environment configs</li>
                                    <li><strong>CLI vars:</strong> CI/CD overrides</li>
                                    <li><strong>ENV vars:</strong> Sensitive values</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <h4>üõ†Ô∏è Enterprise Variable Strategy</h4>
                            <div class="code-block-title">Multi-Environment Setup</div>
                            <pre><code class="language-bash"># Environment-specific variable files
# dev.auto.tfvars
environment = "development"
instance_type = "t2.micro"
enable_monitoring = false
max_cost = 100

# prod.auto.tfvars  
environment = "production"
instance_type = "t3.large"
enable_monitoring = true
max_cost = 5000

# CI/CD Pipeline Variables
export TF_VAR_deployment_id="${BUILD_NUMBER}"
export TF_VAR_git_commit="${GIT_COMMIT}"
export TF_VAR_deployed_by="${BUILD_USER}"

# Override for emergency deployments
terraform apply \
  -var="instance_type=t3.2xlarge" \
  -var="enable_monitoring=true" \
  -var-file="emergency.tfvars"</code></pre>
                            <div class="code-block-title">Secure Secrets Management</div>
                            <pre><code class="language-bash"># Never commit sensitive vars - use env vars
export TF_VAR_db_password="$(aws secretsmanager get-secret-value --secret-id prod/db/password --query SecretString --output text)"
export TF_VAR_api_key="$(vault kv get -field=api_key secret/app/keys)"

# Or use external secret management
terraform apply -var-file=<(aws secretsmanager get-secret-value --secret-id terraform-vars --query SecretString --output text)</code></pre>
                        </div>
                    </div>
                </section>

                <section class="dense-content">
                    <h3>üîê Enterprise Sensitive Data Management</h3>
                    <div class="danger">
                        <p><strong>‚ö†Ô∏è Security Critical:</strong> Never commit sensitive values to version control. Enterprise breaches cost average of $4.45M. Use proper secrets management with zero-trust principles.</p>
                    </div>
                    <div class="terraform-brand" style="margin: 15px 0;">
                        <h4>üè¢ Enterprise Statistics & Industry Standards</h4>
                        <div class="two-column">
                            <div class="column">
                                <ul style="font-size: 0.8em;">
                                    <li><strong>97%</strong> of Fortune 500 use external secret management</li>
                                    <li><strong>$10.9M</strong> average cost of credential exposure breach</li>
                                    <li><strong>86%</strong> of enterprises rotate credentials monthly</li>
                                    <li><strong>Companies using vault:</strong> Netflix, Uber, Airbnb, Slack</li>
                                </ul>
                            </div>
                            <div class="column">
                                <ul style="font-size: 0.8em;">
                                    <li><strong>NIST Cybersecurity Framework</strong> compliance required</li>
                                    <li><strong>SOC 2 Type II</strong> auditing for secret access</li>
                                    <li><strong>Zero-trust architecture</strong> - verify every access</li>
                                    <li><strong>Least privilege principle</strong> - minimum necessary permissions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>üõ°Ô∏è Advanced Sensitive Variable Patterns</h4>
                            <div class="code-block-title">Enterprise Secret Management</div>
                            <pre><code class="language-hcl"># Multi-tier sensitive variable structure
variable "database_credentials" {
  description = "Database authentication configuration"
  type = object({
    master_username = string
    master_password = string
    readonly_username = string
    readonly_password = string
    backup_encryption_key = string
  })
  sensitive = true
  
  validation {
    condition = alltrue([
      can(regex("^[a-zA-Z][a-zA-Z0-9_]{2,15}$", var.database_credentials.master_username)),
      length(var.database_credentials.master_password) >= 14,
      can(regex(".*[A-Z].*", var.database_credentials.master_password)),
      can(regex(".*[a-z].*", var.database_credentials.master_password)),
      can(regex(".*[0-9].*", var.database_credentials.master_password)),
      can(regex(".*[^A-Za-z0-9].*", var.database_credentials.master_password)),
    ])
    error_message = "Database passwords must be 14+ chars with upper, lower, numeric, and special characters."
  }
}

variable "api_integrations" {
  description = "External API credentials and configurations"
  type = map(object({
    api_key = string
    secret_key = string
    base_url = string
    timeout_seconds = number
    rate_limit_rpm = number
    environment_specific = bool
  }))
  sensitive = true
  
  validation {
    condition = alltrue([
      for name, config in var.api_integrations : 
      can(regex("^[A-Za-z0-9_-]{32,}$", config.api_key))
    ])
    error_message = "API keys must be 32+ alphanumeric characters with dashes/underscores only."
  }
  
  validation {
    condition = alltrue([
      for name, config in var.api_integrations : 
      config.timeout_seconds >= 5 && config.timeout_seconds <= 300
    ])
    error_message = "API timeouts must be between 5 and 300 seconds."
  }
}

# Certificate and TLS configuration
variable "tls_certificates" {
  description = "TLS certificate configuration for HTTPS endpoints"
  type = map(object({
    private_key = string
    certificate_body = string
    certificate_chain = optional(string)
    domain_names = list(string)
    auto_renew = bool
  }))
  sensitive = true
  
  validation {
    condition = alltrue([
      for cert_name, cert in var.tls_certificates :
      length(cert.domain_names) > 0
    ])
    error_message = "Each certificate must specify at least one domain name."
  }
}

# OAuth and authentication secrets
variable "oauth_providers" {
  description = "OAuth provider configurations for authentication"
  type = map(object({
    client_id = string
    client_secret = string
    issuer_url = string
    scopes = list(string)
    callback_urls = list(string)
  }))
  sensitive = true
}

# Structured outputs with sensitive data handling
output "application_secrets" {
  description = "Application configuration with masked sensitive values"
  value = {
    # Public configuration
    api_endpoints = {
      for name, config in var.api_integrations :
      name => {
        base_url = config.base_url
        timeout = config.timeout_seconds
        rate_limit = config.rate_limit_rpm
      }
    }
    
    # Sensitive configuration (masked in logs)
    authentication = {
      database_endpoint = "${aws_rds_instance.main.endpoint}:${aws_rds_instance.main.port}"
      database_name = aws_rds_instance.main.db_name
      # Passwords and keys not included in output
    }
    
    # Connection templates with placeholders
    connection_templates = {
      database = "postgresql://[USERNAME]:[PASSWORD]@${aws_rds_instance.main.endpoint}:${aws_rds_instance.main.port}/${aws_rds_instance.main.db_name}?sslmode=require"
      redis = "redis://[PASSWORD]@${aws_elasticache_cluster.main.cache_nodes[0].address}:${aws_elasticache_cluster.main.cache_nodes[0].port}"
    }
  }
  sensitive = true
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üîí Enterprise Secret Integration Patterns</h4>
                            <div class="code-block-title">AWS Secrets Manager Integration</div>
                            <pre><code class="language-hcl"># Data source for existing secrets
data "aws_secretsmanager_secret_version" "database_credentials" {
  secret_id = "production/database/credentials"
}

data "aws_secretsmanager_secret_version" "api_keys" {
  secret_id = "production/api/integrations"
}

# Parse JSON secrets into usable format
locals {
  database_secrets = jsondecode(data.aws_secretsmanager_secret_version.database_credentials.secret_string)
  api_secrets = jsondecode(data.aws_secretsmanager_secret_version.api_keys.secret_string)
  
  # Environment-specific secret handling
  environment_secrets = {
    for env in ["development", "staging", "production"] :
    env => {
      database_password = try(local.database_secrets[env].password, local.database_secrets.default.password)
      encryption_key = try(local.database_secrets[env].encryption_key, local.database_secrets.default.encryption_key)
    }
  }
}

# AWS Systems Manager Parameter Store integration
data "aws_ssm_parameter" "oauth_client_secret" {
  name = "/production/oauth/${var.oauth_provider}/client_secret"
  with_decryption = true
}

# HashiCorp Vault integration (when available)
data "vault_generic_secret" "database" {
  count = var.use_vault ? 1 : 0
  path = "secret/terraform/${var.environment}/database"
}

locals {
  vault_database_config = var.use_vault ? data.vault_generic_secret.database[0].data : {}
}</code></pre>
                            
                            <div class="code-block-title">CI/CD Environment Integration</div>
                            <pre><code class="language-bash"># GitHub Actions environment setup
export TF_VAR_database_credentials=$(cat <<EOF
{
  "master_username": "${{ secrets.DB_MASTER_USERNAME }}",
  "master_password": "${{ secrets.DB_MASTER_PASSWORD }}",
  "readonly_username": "${{ secrets.DB_READONLY_USERNAME }}",
  "readonly_password": "${{ secrets.DB_READONLY_PASSWORD }}",
  "backup_encryption_key": "${{ secrets.DB_BACKUP_KEY }}"
}
EOF
)

# Azure DevOps variable groups
export TF_VAR_api_integrations=$(az keyvault secret show \
  --name "terraform-api-integrations" \
  --vault-name "${{ variables.KEY_VAULT_NAME }}" \
  --query value -o tsv)

# GitLab CI/CD with HashiCorp Vault
export VAULT_TOKEN=$(vault write -field=token auth/jwt/login \
  role=gitlab-ci jwt=$CI_JOB_JWT)

export TF_VAR_tls_certificates=$(vault kv get \
  -field=certificates secret/terraform/$CI_ENVIRONMENT_NAME/tls)

# Jenkins with AWS IAM roles
export TF_VAR_oauth_providers=$(aws secretsmanager get-secret-value \
  --secret-id "terraform/${ENVIRONMENT}/oauth-providers" \
  --region $AWS_REGION \
  --query SecretString --output text)
</code></pre>
                            
                            <h4>üèÜ Enterprise Security Best Practices</h4>
                            <div class="success" style="padding: 12px;">
                                <h5>üîí Secret Management Hierarchy:</h5>
                                <ol style="font-size: 0.8em; line-height: 1.3;">
                                    <li><strong>HashiCorp Vault</strong> - Dynamic secrets, policy-driven</li>
                                    <li><strong>AWS Secrets Manager</strong> - Automatic rotation, cross-service</li>
                                    <li><strong>Azure Key Vault</strong> - RBAC, audit logging, HSM backing</li>
                                    <li><strong>Google Secret Manager</strong> - IAM integration, versioning</li>
                                    <li><strong>CI/CD Native</strong> - GitHub/GitLab/Azure secrets (last resort)</li>
                                </ol>
                            </div>
                            
                            <div class="highlight" style="padding: 12px; margin-top: 10px;">
                                <h5>‚ö° Secrets Rotation Strategy:</h5>
                                <ul style="font-size: 0.8em; line-height: 1.3;">
                                    <li><strong>Database passwords:</strong> 30-day rotation with blue/green</li>
                                    <li><strong>API keys:</strong> 90-day rotation with overlap period</li>
                                    <li><strong>TLS certificates:</strong> Auto-renewal 30 days before expiry</li>
                                    <li><strong>Service accounts:</strong> 60-day rotation with validation</li>
                                    <li><strong>OAuth tokens:</strong> Short-lived with refresh capability</li>
                                </ul>
                            </div>
                            
                            <div class="enterprise" style="padding: 12px; margin-top: 10px;">
                                <h5>üìä Compliance & Auditing:</h5>
                                <ul style="font-size: 0.8em; line-height: 1.3;">
                                    <li><strong>SOC 2 Type II:</strong> Access logging, approval workflows</li>
                                    <li><strong>PCI DSS:</strong> Encrypted storage, key escrow, rotation</li>
                                    <li><strong>HIPAA:</strong> Access controls, data classification, audit trails</li>
                                    <li><strong>ISO 27001:</strong> Risk assessment, incident response, training</li>
                                    <li><strong>NIST:</strong> Framework alignment, continuous monitoring</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="danger" style="margin-top: 20px;">
                        <h4>üö® Common Security Anti-Patterns to Avoid</h4>
                        <div class="three-column">
                            <div class="column">
                                <h5 style="color: #dc3545;">‚ùå Never Do</h5>
                                <ul style="font-size: 0.75em;">
                                    <li>Hardcode secrets in .tf files</li>
                                    <li>Commit .tfvars with secrets</li>
                                    <li>Use weak or default passwords</li>
                                    <li>Share secrets via chat/email</li>
                                    <li>Store secrets in documentation</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h5 style="color: #28a745;">‚úÖ Always Do</h5>
                                <ul style="font-size: 0.75em;">
                                    <li>Use external secret stores</li>
                                    <li>Mark sensitive variables as sensitive</li>
                                    <li>Implement secret rotation</li>
                                    <li>Audit secret access regularly</li>
                                    <li>Use least privilege access</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h5 style="color: #fd7e14;">‚ö†Ô∏è Monitor</h5>
                                <ul style="font-size: 0.75em;">
                                    <li>Failed authentication attempts</li>
                                    <li>Unusual access patterns</li>
                                    <li>Secret age and rotation status</li>
                                    <li>Cross-environment access</li>
                                    <li>Compliance drift indicators</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>üìä Advanced Output Patterns</h3>
                    <div class="terraform-brand">
                        <p><strong>Enterprise Pattern:</strong> Structure outputs for easy consumption by other teams and systems.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>Structured Output Objects</h4>
                            <pre><code class="language-hcl">output "network_configuration" {
  description = "Complete network setup for downstream consumption"
  value = {
    vpc = {
      id         = aws_vpc.main.id
      cidr_block = aws_vpc.main.cidr_block
      region     = data.aws_region.current.name
    }
    
    subnets = {
      public = [for s in aws_subnet.public : {
        id               = s.id
        cidr_block       = s.cidr_block
        availability_zone = s.availability_zone
      }]
      private = [for s in aws_subnet.private : {
        id               = s.id
        cidr_block       = s.cidr_block
        availability_zone = s.availability_zone
      }]
    }
    
    security = {
      bastion_sg_id = aws_security_group.bastion.id
      web_sg_id     = aws_security_group.web.id
      db_sg_id      = aws_security_group.database.id
    }
  }
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>Conditional Outputs</h4>
                            <pre><code class="language-hcl"># Output only in specific environments
output "debug_information" {
  description = "Debugging info for non-production"
  value = var.environment != "production" ? {
    state_bucket = data.terraform_remote_state.backend.outputs.bucket_name
    workspace    = terraform.workspace
    caller_arn   = data.aws_caller_identity.current.arn
  } : null
}

# Preconditions for outputs
output "application_endpoint" {
  description = "Application access URL"
  value       = "https://${aws_route53_record.app.fqdn}"
  
  precondition {
    condition     = aws_lb.main.load_balancer_type == "application"
    error_message = "Application endpoint requires ALB."
  }
}</code></pre>
                            
                            <h4>Output Documentation</h4>
                            <div class="success">
                                <p><strong>Best Practice:</strong> Always include descriptions and structure outputs logically for API-like consumption.</p>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Lab 5 Callout -->
            <section class="lab-callout" data-background-color="#17a2b8">
                <div style="text-align: center; color: white;">
                    <h1><span class="emoji">‚òÅÔ∏è</span> State Management Challenge!</h1>
                    <h2><span class="emoji">üóÑÔ∏è</span> Lab 6: Remote State Management</h2>
                    <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <h3>üéØ What You'll Master:</h3>
                        <ul style="font-size: 1.1em; line-height: 1.6;">
                            <li>‚úÖ Implement secure S3 + DynamoDB backend with encryption</li>
                            <li>‚úÖ Configure state locking to prevent concurrent modifications</li>
                            <li>‚úÖ Migrate local state to production-ready remote backend</li>
                            <li>‚úÖ Handle lifecycle policies, versioning, and cost optimization</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,193,7,0.2); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #ffc107;">
                        
                        <p style="font-size: 1.1em; margin: 10px 0 0 0;">Build production-ready state management for team collaboration!</p>
                    </div>
                    <h2 style="margin-top: 30px; font-size: 2em;">üåä Master State Management!</h2>
                </div>
            </section>

            <!-- Section 2: Resource Dependencies and Lifecycle -->
            <section>
                <section class="section-divider">
                    <h2>üîó Section 2: Resource Dependencies & Lifecycle</h2>
                    <p>Master resource orchestration and lifecycle management patterns</p>
                </section>

                <section>
                    <h3>üîó Understanding Resource Dependencies</h3>
                    <div class="terraform-brand">
                        <p><strong>Dependency Orchestration:</strong> Terraform's dependency graph determines resource creation order. Understanding implicit vs explicit dependencies is crucial for complex infrastructure.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>‚ö° Implicit Dependencies</h4>
                            <div class="success">
                                <p><strong>Automatic Detection:</strong> Terraform analyzes resource references</p>
                            </div>
                            <div class="code-block-title">Automatic Dependency Chain</div>
                            <pre><code class="language-hcl"># VPC created first
resource "aws_vpc" "main" {
  cidr_block           = "10.0.0.0/16"
  enable_dns_hostnames = true
  enable_dns_support   = true
  
  tags = {
    Name = "${var.project_name}-vpc"
  }
}

# Internet Gateway depends on VPC
resource "aws_internet_gateway" "main" {
  vpc_id = aws_vpc.main.id  # ‚Üê Creates dependency
  
  tags = {
    Name = "${var.project_name}-igw"
  }
}

# Subnet depends on VPC
resource "aws_subnet" "web" {
  vpc_id            = aws_vpc.main.id  # ‚Üê Creates dependency
  cidr_block        = "10.0.1.0/24"
  availability_zone = data.aws_availability_zones.available.names[0]
  
  map_public_ip_on_launch = true
  
  tags = {
    Name = "${var.project_name}-public-1"
    Type = "public"
  }
}

# Route table depends on VPC and IGW
resource "aws_route_table" "public" {
  vpc_id = aws_vpc.main.id  # ‚Üê VPC dependency
  
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.main.id  # ‚Üê IGW dependency
  }
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üéØ Explicit Dependencies</h4>
                            <div class="highlight">
                                <p><strong>Manual Control:</strong> Force dependencies when Terraform can't detect them</p>
                            </div>
                            <div class="code-block-title">Complex Dependency Management</div>
                            <pre><code class="language-hcl"># EC2 instance with explicit dependencies
resource "aws_instance" "web" {
  ami                    = data.aws_ami.ubuntu.id
  instance_type          = var.instance_type
  subnet_id              = aws_subnet.web.id
  vpc_security_group_ids = [aws_security_group.web.id]
  
  # Explicit dependencies for proper ordering
  depends_on = [
    aws_security_group.web,        # Security must be ready
    aws_iam_role_policy.s3_access, # IAM permissions ready
    aws_s3_bucket.app_data,        # S3 bucket exists
    aws_nat_gateway.main           # NAT gateway operational
  ]
  
  # User data script that needs S3 access
  user_data = <<-EOF
    #!/bin/bash
    aws s3 cp s3://${aws_s3_bucket.app_data.id}/bootstrap.sh /tmp/
    chmod +x /tmp/bootstrap.sh
    /tmp/bootstrap.sh
  EOF
  
  tags = {
    Name = "${var.project_name}-web-server"
    Role = "web"
  }
}

# Application Load Balancer with health check dependencies
resource "aws_lb" "main" {
  name               = "${var.project_name}-alb"
  internal           = false
  load_balancer_type = "application"
  subnets            = aws_subnet.public[*].id
  security_groups    = [aws_security_group.alb.id]
  
  depends_on = [
    aws_internet_gateway.main,  # Internet access required
    aws_route_table_association.public  # Routing configured
  ]
}</code></pre>
                        </div>
                    </div>
                    <div class="info">
                        <h4>üîç When to Use Explicit Dependencies</h4>
                        <ul>
                            <li><strong>IAM Permissions:</strong> Ensure roles/policies exist before resource creation</li>
                            <li><strong>Network Readiness:</strong> Guarantee routing/gateways are operational</li>
                            <li><strong>External Resources:</strong> Dependencies on resources outside Terraform control</li>
                            <li><strong>Timing Issues:</strong> Resources that need time to become fully operational</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h3>üîÑ Advanced Resource Lifecycle Management</h3>
                    <div class="info">
                        <p><strong>Production Reality:</strong> Lifecycle rules prevent downtime, data loss, and configuration drift in enterprise environments.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>üõ°Ô∏è Protection Strategies</h4>
                            <div class="code-block-title">Critical Resource Protection</div>
                            <pre><code class="language-hcl"># Database with comprehensive protection
resource "aws_rds_instance" "production" {
  identifier = "${var.project_name}-prod-db"
  engine     = "postgresql"
  engine_version = "14.9"
  instance_class = "db.t3.large"
  
  allocated_storage     = 100
  max_allocated_storage = 1000
  storage_encrypted     = true
  
  db_name  = var.database_name
  username = var.database_username
  password = var.database_password
  
  backup_retention_period = 30
  backup_window          = "03:00-04:00"
  maintenance_window     = "sun:04:00-sun:05:00"
  
  skip_final_snapshot = false
  final_snapshot_identifier = "${var.project_name}-prod-db-final-snapshot-${formatdate("YYYY-MM-DD-hhmm", timestamp())}"
  
  lifecycle {
    # Critical: Prevent accidental deletion
    prevent_destroy = true
    
    # Ignore password changes (managed externally)
    ignore_changes = [
      password,
      final_snapshot_identifier
    ]
  }
  
  tags = {
    Name        = "${var.project_name}-production-database"
    Environment = "production"
    Critical    = "true"
    BackupTier  = "tier-1"
  }
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üîÑ Zero-Downtime Updates</h4>
                            <div class="code-block-title">Application Server with Rolling Updates</div>
                            <pre><code class="language-hcl"># Web server with zero-downtime replacement
resource "aws_launch_template" "web" {
  name_prefix   = "${var.project_name}-web-"
  image_id      = data.aws_ami.ubuntu.id
  instance_type = var.instance_type
  
  vpc_security_group_ids = [aws_security_group.web.id]
  
  user_data = base64encode(templatefile("userdata.sh", {
    app_version = var.app_version
    environment = var.environment
  }))
  
  tag_specifications {
    resource_type = "instance"
    tags = local.common_tags
  }
  
  lifecycle {
    # Replace launch template before updating ASG
    create_before_destroy = true
    
    # Force replacement when user data changes
    replace_triggered_by = [
      var.app_version
    ]
  }
}

resource "aws_autoscaling_group" "web" {
  name                = "${var.project_name}-web-asg"
  vpc_zone_identifier = aws_subnet.private[*].id
  target_group_arns   = [aws_lb_target_group.web.arn]
  health_check_type   = "ELB"
  health_check_grace_period = 300
  
  min_size         = var.min_size
  max_size         = var.max_size
  desired_capacity = var.desired_capacity
  
  launch_template {
    id      = aws_launch_template.web.id
    version = "$Latest"
  }
  
  # Lifecycle for zero-downtime deployments
  lifecycle {
    create_before_destroy = true
    
    # Ignore desired capacity changes (managed by auto-scaling)
    ignore_changes = [desired_capacity]
  }
  
  # Rolling update configuration
  instance_refresh {
    strategy = "Rolling"
    preferences {
      min_healthy_percentage = 50
      instance_warmup       = 300
    }
  }
}</code></pre>
                        </div>
                    </div>
                    <div class="danger">
                        <h4>‚ö†Ô∏è Lifecycle Best Practices</h4>
                        <ul class="warning-list">
                            <li><strong>prevent_destroy:</strong> Use on databases, state stores, and critical data resources</li>
                            <li><strong>create_before_destroy:</strong> Essential for load-balanced services and DNS records</li>
                            <li><strong>ignore_changes:</strong> Use sparingly - can hide important configuration drift</li>
                            <li><strong>replace_triggered_by:</strong> Force replacement when dependencies change significantly</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h3>üî¢ Count vs For_Each: Enterprise Patterns</h3>
                    <div class="terraform-brand">
                        <p><strong>Scale Challenge:</strong> Choose the right iteration pattern for maintainable, scalable infrastructure that adapts to changing requirements.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>üî¢ Count: Sequential Resources</h4>
                            <div class="success">
                                <p><strong>Best for:</strong> Fixed-size lists, sequential naming, efficient replication</p>
                            </div>
                            <div class="code-block-title">Multi-AZ Subnet Creation</div>
                            <pre><code class="language-hcl"># Private subnets across AZs
resource "aws_subnet" "private" {
  count = length(data.aws_availability_zones.available.names)
  
  vpc_id            = aws_vpc.main.id
  cidr_block        = cidrsubnet(var.vpc_cidr, 8, count.index + 10)
  availability_zone = data.aws_availability_zones.available.names[count.index]
  
  map_public_ip_on_launch = false
  
  tags = merge(local.common_tags, {
    Name = "${var.project_name}-private-${count.index + 1}"
    Type = "private"
    AZ   = data.aws_availability_zones.available.names[count.index]
    Tier = "application"
  })
}

# NAT Gateways for each private subnet
resource "aws_nat_gateway" "private" {
  count = var.multi_az_nat ? length(aws_subnet.private) : 1
  
  allocation_id = aws_eip.nat[count.index].id
  subnet_id     = aws_subnet.public[count.index].id
  
  tags = merge(local.common_tags, {
    Name = "${var.project_name}-nat-${count.index + 1}"
    AZ   = aws_subnet.public[count.index].availability_zone
  })
  
  depends_on = [aws_internet_gateway.main]
}</code></pre>
                            <div class="highlight">
                                <p><strong>üí° Pro Tip:</strong> Count is ideal when you need predictable indexing and resource ordering.</p>
                            </div>
                        </div>
                        <div class="column">
                            <h4>üîÅ For_Each: Dynamic Resources</h4>
                            <div class="info">
                                <p><strong>Best for:</strong> Named resources, complex configurations, flexible scaling</p>
                            </div>
                            <div class="code-block-title">Dynamic Security Group Rules</div>
                            <pre><code class="language-hcl"># Complex security rules from variable
variable "security_rules" {
  type = map(object({
    description = string
    from_port   = number
    to_port     = number
    protocol    = string
    cidr_blocks = list(string)
    source_sg   = optional(string)
  }))
  default = {
    "web_http" = {
      description = "HTTP access from ALB"
      from_port   = 80
      to_port     = 80
      protocol    = "tcp"
      cidr_blocks = []
      source_sg   = "alb"
    },
    "web_https" = {
      description = "HTTPS access from ALB"
      from_port   = 443
      to_port     = 443
      protocol    = "tcp"
      cidr_blocks = []
      source_sg   = "alb"
    },
    "ssh_admin" = {
      description = "SSH access from admin network"
      from_port   = 22
      to_port     = 22
      protocol    = "tcp"
      cidr_blocks = ["10.0.0.0/8"]
      source_sg   = null
    }
  }
}

resource "aws_security_group_rule" "ingress" {
  for_each = var.security_rules
  
  type              = "ingress"
  from_port         = each.value.from_port
  to_port           = each.value.to_port
  protocol          = each.value.protocol
  description       = each.value.description
  security_group_id = aws_security_group.web.id
  
  # Conditional source configuration
  cidr_blocks = length(each.value.cidr_blocks) > 0 ? each.value.cidr_blocks : null
  source_security_group_id = each.value.source_sg != null ? aws_security_group[each.value.source_sg].id : null
}</code></pre>
                            <div class="highlight">
                                <p><strong>üí° Pro Tip:</strong> For_each provides stable resource addressing even when the middle item is removed.</p>
                            </div>
                        </div>
                    </div>
                    <div class="danger">
                        <h4>‚ö†Ô∏è Common Pitfalls</h4>
                        <table>
                            <tr>
                                <th>Pattern</th>
                                <th>Problem</th>
                                <th>Solution</th>
                            </tr>
                            <tr>
                                <td><strong>Count</strong></td>
                                <td>Removing middle items causes resource recreation</td>
                                <td>Use for_each for stable resource names</td>
                            </tr>
                            <tr>
                                <td><strong>For_each</strong></td>
                                <td>Cannot use with unknown values at plan time</td>
                                <td>Use known values or locals with known keys</td>
                            </tr>
                            <tr>
                                <td><strong>Both</strong></td>
                                <td>Cannot mix count and for_each on same resource</td>
                                <td>Choose one pattern per resource type</td>
                            </tr>
                        </table>
                    </div>
                </section>

                <section>
                    <h3>‚ö° Dynamic Blocks: Flexible Resource Configuration</h3>
                    <div class="info">
                        <p><strong>Advanced Pattern:</strong> Dynamic blocks allow conditional and iterative configuration within resources, perfect for complex enterprise requirements.</p>
                    </div>
                    <div class="code-block-title">Enterprise Security Group with Dynamic Configuration</div>
                    <pre><code class="language-hcl"># Complex security group with multiple dynamic blocks
resource "aws_security_group" "application" {
  name_prefix = "${var.project_name}-${var.environment}-app-"
  vpc_id      = var.vpc_id
  description = "Application security group with dynamic rules"
  
  # Dynamic ingress rules based on environment
  dynamic "ingress" {
    for_each = var.ingress_rules
    content {
      description = "${ingress.value.description} (${var.environment})"
      from_port   = ingress.value.from_port
      to_port     = ingress.value.to_port
      protocol    = ingress.value.protocol
      
      # Conditional CIDR blocks based on environment
      cidr_blocks = var.environment == "production" ? 
        ingress.value.prod_cidrs : 
        ingress.value.dev_cidrs
      
      # Optional security group references
      security_groups = lookup(ingress.value, "source_security_groups", [])
    }
  }
  
  # Environment-specific egress rules
  dynamic "egress" {
    for_each = var.environment == "production" ? var.prod_egress_rules : var.dev_egress_rules
    content {
      description = egress.value.description
      from_port   = egress.value.from_port
      to_port     = egress.value.to_port
      protocol    = egress.value.protocol
      cidr_blocks = egress.value.cidr_blocks
    }
  }
  
  tags = merge(local.common_tags, {
    Name = "${var.project_name}-${var.environment}-application-sg"
    Type = "application"
  })
}

# Advanced Launch Template with dynamic block patterns
resource "aws_launch_template" "app" {
  name_prefix   = "${var.project_name}-app-"
  image_id      = data.aws_ami.app.id
  instance_type = var.instance_type
  key_name      = var.key_pair_name
  
  vpc_security_group_ids = [aws_security_group.application.id]
  
  # Dynamic network interfaces for multi-ENI instances
  dynamic "network_interfaces" {
    for_each = var.multi_eni_config != null ? [var.multi_eni_config] : []
    content {
      associate_public_ip_address = network_interfaces.value.public_ip
      subnet_id                   = network_interfaces.value.subnet_id
      security_groups            = network_interfaces.value.security_groups
      device_index               = network_interfaces.value.device_index
    }
  }
  
  # Dynamic EBS block devices
  dynamic "block_device_mappings" {
    for_each = var.additional_ebs_volumes
    content {
      device_name = block_device_mappings.key
      ebs {
        volume_size           = block_device_mappings.value.size
        volume_type           = block_device_mappings.value.type
        encrypted            = var.environment == "production" ? true : block_device_mappings.value.encrypted
        delete_on_termination = block_device_mappings.value.delete_on_termination
        
        # Conditional IOPS for high-performance volumes
        iops = block_device_mappings.value.type == "gp3" ? block_device_mappings.value.iops : null
      }
    }
  }
  
  # Dynamic tags for resources created from this template
  dynamic "tag_specifications" {
    for_each = ["instance", "volume", "network-interface"]
    content {
      resource_type = tag_specifications.value
      tags = merge(local.common_tags, {
        Name = "${var.project_name}-${var.environment}-app"
        LaunchedFrom = "launch-template"
      })
    }
  }
}</code></pre>
                    <div class="two-column">
                        <div class="column">
                            <div class="success">
                                <h4>üöÄ Dynamic Block Benefits</h4>
                                <ul>
                                    <li>Conditional resource configuration</li>
                                    <li>Environment-specific adaptability</li>
                                    <li>Reduced code duplication</li>
                                    <li>Complex nested structures</li>
                                    <li>Runtime configuration flexibility</li>
                                </ul>
                            </div>
                        </div>
                        <div class="column">
                            <div class="highlight">
                                <h4>üí° Best Practices</h4>
                                <ul>
                                    <li>Use for optional resource blocks</li>
                                    <li>Combine with conditional expressions</li>
                                    <li>Keep iterator names descriptive</li>
                                    <li>Test with different input combinations</li>
                                    <li>Document complex dynamic patterns</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>üîÑ Advanced Lifecycle Management</h3>
                    <div class="terraform-brand">
                        <p><strong>Production Requirement:</strong> Control resource replacement behavior to prevent service disruptions and data loss.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>Lifecycle Rules in Practice</h4>
                            <pre><code class="language-hcl">resource "aws_instance" "critical_server" {
  ami           = data.aws_ami.latest.id
  instance_type = var.instance_type
  
  lifecycle {
    # Prevent accidental deletion
    prevent_destroy = true
    
    # Create new before destroying old
    create_before_destroy = true
    
    # Ignore AMI changes (managed externally)
    ignore_changes = [ami, user_data]
    
    # Replace only when specific changes occur
    replace_triggered_by = [
      aws_security_group.web.id
    ]
  }
  
  # Custom condition for replacement
  precondition {
    condition = can(regex("^t[23]\\.", var.instance_type))
    error_message = "Instance must be T2 or T3 family."
  }
  
  postcondition {
    condition = self.instance_state == "running"
    error_message = "Instance failed to start properly."
  }
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>Data Persistence Patterns</h4>
                            <pre><code class="language-hcl"># RDS with snapshot on deletion
resource "aws_db_instance" "production" {
  identifier = "${var.project}-db"
  
  # Snapshot before deletion
  skip_final_snapshot = false
  final_snapshot_identifier = "${var.project}-final-${formatdate("YYYY-MM-DD-hhmm", timestamp())}"
  
  # Prevent deletion in production
  deletion_protection = var.environment == "production"
  
  lifecycle {
    prevent_destroy = true
    ignore_changes = [password]
  }
}

# EBS Volume with lifecycle management
resource "aws_ebs_volume" "data" {
  availability_zone = var.az
  size             = var.volume_size
  type             = "gp3"
  encrypted        = true
  
  lifecycle {
    prevent_destroy = true
    
    # Prevent shrinking
    precondition {
      condition = var.volume_size >= 100
      error_message = "Volume must be at least 100GB."
    }
  }
}</code></pre>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>üéØ Resource Targeting and Partial Applies</h3>
                    <div class="danger">
                        <p><strong>‚ö†Ô∏è Use with Caution:</strong> Resource targeting can create state inconsistencies. Use only for debugging or emergency fixes.</p>
                    </div>
                    <div class="two-column">
                        <div class="column">
                            <h4>Targeted Operations</h4>
                            <pre><code class="language-bash"># Apply only specific resources
terraform apply -target=aws_instance.web
terraform apply -target=module.networking

# Destroy specific resources
terraform destroy -target=aws_instance.temp

# Plan with targets
terraform plan -target=aws_security_group.web \
               -target=aws_security_group_rule.web_ingress

# Refresh specific resources
terraform apply -refresh-only \
                -target=data.aws_ami.latest</code></pre>
                            
                            <h4>When to Use Targeting</h4>
                            <ul>
                                <li>üîß Debugging resource-specific issues</li>
                                <li>üö® Emergency rollbacks</li>
                                <li>üîÑ Incremental migrations</li>
                                <li>‚ö° Testing individual changes</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Resource Replacement Strategies</h4>
                            <pre><code class="language-bash"># Force replacement of a resource
terraform apply -replace=aws_instance.web

# Taint resource for replacement
terraform taint aws_instance.web
terraform apply

# Untaint if mistake
terraform untaint aws_instance.web

# Import existing resources
terraform import aws_instance.existing i-1234567890abcdef0

# Remove from state without destroying
terraform state rm aws_instance.old</code></pre>
                            
                            <div class="highlight">
                                <p><strong>üí° Best Practice:</strong> Always run `terraform plan` after targeted operations to ensure state consistency.</p>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Lab 6 Callout -->
            <section class="lab-callout" data-background-color="#6610f2">
                <div style="text-align: center; color: white;">
                    <h1><span class="emoji">üîê</span> Advanced State Mastery!</h1>
                    <h2><span class="emoji">üóÇÔ∏è</span> Lab 7: Terraform Registry Modules</h2>
                    <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <h3>üéØ What You'll Master:</h3>
                        <ul style="font-size: 1.0em; line-height: 1.4;">
                            <li>‚úÖ Multi-module infrastructure composition (6+ modules)</li>
                            <li>‚úÖ VPC, ALB, RDS, S3, Auto Scaling integration</li>
                            <li>‚úÖ KMS encryption and Parameter Store secrets</li>
                            <li>‚úÖ Production-ready enterprise patterns</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,193,7,0.2); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #ffc107;">
                        
                        <p style="font-size: 1.0em; margin: 8px 0 0 0;">Master enterprise-grade module composition!</p>
                    </div>
                    <h2 style="margin-top: 20px; font-size: 1.8em;">üîí Advanced Module Patterns!</h2>
                </div>
            </section>

            <!-- Section 3: Data Sources and Remote State -->
            <section>
                <section class="section-divider">
                    <h2>üìä Section 3: Data Sources & Remote State</h2>
                    <p>Integrate existing infrastructure and enable cross-stack collaboration</p>
                </section>

                <section class="dense-content">
                    <h3>üîç Advanced Data Sources & Integration Patterns</h3>
                    <div class="terraform-brand">
                        <h4>üìä Enterprise Data Integration Strategy</h4>
                        <p><strong>Data-Driven Infrastructure:</strong> Modern enterprise architecture requires dynamic infrastructure that adapts to existing resources, compliance requirements, and organizational standards. 78% of Fortune 500 companies use data sources for cross-stack integration.</p>
                    </div>
                    
                    <div class="two-column">
                        <div class="column">
                            <h4>üèóÔ∏è Advanced AMI Selection Patterns</h4>
                            <div class="code-block-title">Dynamic AMI Selection with Compliance</div>
                            <pre><code class="language-hcl"># Enterprise AMI selection with multiple criteria
data "aws_ami" "enterprise_base" {
  most_recent = true
  owners      = [
    "099720109477", # Canonical
    "137112412989", # Amazon
    var.custom_ami_account_id # Organization's AMI account
  ]
  
  filter {
    name = "name"
    values = var.environment == "production" ? [
      "ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*",
      "amzn2-ami-hvm-*-x86_64-gp2"
    ] : [
      "ubuntu/images/hvm-ssd/ubuntu-*-amd64-server-*"
    ]
  }
  
  filter {
    name   = "virtualization-type"
    values = ["hvm"]
  }
  
  filter {
    name   = "state"
    values = ["available"]
  }
  
  # Compliance requirement: Only EBS-backed AMIs
  filter {
    name   = "root-device-type"
    values = ["ebs"]
  }
  
  # Security requirement: Encrypted snapshots only in production
  dynamic "filter" {
    for_each = var.environment == "production" ? [1] : []
    content {
      name   = "block-device-mapping.encrypted"
      values = ["true"]
    }
  }
}

# Organization-specific AMI selection
data "aws_ami" "golden_image" {
  most_recent = true
  owners      = [var.organization_account_id]
  
  filter {
    name   = "tag:ImageType"
    values = ["GoldenImage"]
  }
  
  filter {
    name   = "tag:Environment"
    values = [var.environment, "all"]
  }
  
  filter {
    name   = "tag:ComplianceLevel"
    values = [var.compliance_level]
  }
  
  filter {
    name   = "tag:PatchLevel"
    values = ["current"]
  }
}

# Multi-architecture AMI selection
data "aws_ami" "application_ami" {
  for_each = toset(var.supported_architectures)
  
  most_recent = true
  owners      = ["self", var.trusted_ami_accounts]
  
  filter {
    name   = "name"
    values = ["${var.application_name}-${each.key}-*"]
  }
  
  filter {
    name   = "architecture"
    values = [each.key]
  }
  
  filter {
    name   = "tag:Application"
    values = [var.application_name]
  }
  
  filter {
    name   = "tag:BuildDate"
    values = [formatdate("YYYY-MM", timestamp())]
  }
}

locals {
  # Select architecture based on instance type
  selected_architecture = can(regex("graviton|a1|t4g|m6g|c6g|r6g", var.instance_type)) ? "arm64" : "x86_64"
  selected_ami = try(
    data.aws_ami.application_ami[local.selected_architecture].id,
    data.aws_ami.golden_image.id,
    data.aws_ami.enterprise_base.id
  )
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üåê Network Discovery & Integration</h4>
                            <div class="code-block-title">Advanced VPC and Network Discovery</div>
                            <pre><code class="language-hcl"># Multi-criteria VPC discovery
data "aws_vpc" "application_vpc" {
  # Primary discovery method - by tags
  tags = {
    Environment     = var.environment
    Project         = var.project_name
    NetworkTier     = var.network_tier
    ComplianceZone  = var.compliance_zone
  }
  
  # Fallback discovery methods
  dynamic "filter" {
    for_each = var.vpc_id != null ? [] : [1]
    content {
      name   = "tag:Name"
      values = ["${var.project_name}-${var.environment}-vpc"]
    }
  }
}

# Discover all subnets with classification
data "aws_subnets" "application_subnets" {
  filter {
    name   = "vpc-id"
    values = [data.aws_vpc.application_vpc.id]
  }
  
  filter {
    name   = "tag:Type"
    values = var.require_private ? ["private"] : ["private", "public"]
  }
  
  filter {
    name   = "tag:Tier"
    values = [var.subnet_tier]
  }
  
  filter {
    name   = "availability-zone"
    values = data.aws_availability_zones.available.names
  }
}

# Advanced subnet details with metadata
data "aws_subnet" "application_subnet_details" {
  for_each = toset(data.aws_subnets.application_subnets.ids)
  id       = each.value
}

locals {
  # Organize subnets by AZ for high availability
  subnets_by_az = {
    for subnet_id, subnet in data.aws_subnet.application_subnet_details :
    subnet.availability_zone => subnet.id...
  }
  
  # Select balanced subnet distribution
  selected_subnets = [
    for az in slice(sort(keys(local.subnets_by_az)), 0, min(length(keys(local.subnets_by_az)), var.max_availability_zones)) :
    local.subnets_by_az[az][0]
  ]
}

# Security group discovery with inheritance
data "aws_security_group" "base_security_groups" {
  for_each = toset(var.inherit_security_groups)
  
  filter {
    name   = "tag:Name"
    values = [each.value]
  }
  
  filter {
    name   = "vpc-id"
    values = [data.aws_vpc.application_vpc.id]
  }
}

# Route table analysis for network planning
data "aws_route_table" "subnet_routes" {
  for_each = toset(local.selected_subnets)
  
  filter {
    name   = "association.subnet-id"
    values = [each.value]
  }
}

locals {
  # Analyze routing patterns
  internet_accessible_subnets = [
    for subnet_id, route_table in data.aws_route_table.subnet_routes :
    subnet_id if contains([
      for route in route_table.routes :
      route.gateway_id
    ], data.aws_internet_gateway.vpc_igw.id)
  ]
}</code></pre>
                        </div>
                    </div>
                    
                    <div class="enterprise" style="margin: 15px 0;">
                        <h4>üè¢ Enterprise Resource Discovery Patterns</h4>
                        <div class="two-column">
                            <div class="column">
                                <h5>üìã Compliance-Driven Selection:</h5>
                                <ul style="font-size: 0.8em;">
                                    <li><strong>HIPAA:</strong> Encrypted AMIs, dedicated tenancy</li>
                                    <li><strong>PCI DSS:</strong> Specific security groups, isolated networks</li>
                                    <li><strong>SOC 2:</strong> Audited AMIs, tagged resources</li>
                                    <li><strong>FedRAMP:</strong> GovCloud regions, approved images</li>
                                </ul>
                            </div>
                            <div class="column">
                                <h5>üéØ Resource Optimization:</h5>
                                <ul style="font-size: 0.8em;">
                                    <li><strong>Cost:</strong> Spot-eligible AMIs, right-sized instances</li>
                                    <li><strong>Performance:</strong> Latest generation, optimized storage</li>
                                    <li><strong>Security:</strong> Hardened images, encrypted storage</li>
                                    <li><strong>Availability:</strong> Multi-AZ distribution, redundancy</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="two-column" style="margin-top: 20px;">
                        <div class="column">
                            <h4>üîç Advanced Data Source Caching</h4>
                            <div class="code-block-title">Performance Optimization Patterns</div>
                            <pre><code class="language-hcl"># Cache expensive data source calls
locals {
  # Cache AZ data - called once, used multiple times
  availability_zones = data.aws_availability_zones.available.names
  
  # Cache account and region information
  current_region = data.aws_region.current.name
  current_account = data.aws_caller_identity.current.account_id
  
  # Pre-computed subnet mappings
  subnet_mappings = {
    for subnet_id in data.aws_subnets.application_subnets.ids :
    subnet_id => data.aws_subnet.application_subnet_details[subnet_id]
  }
}

# Conditional data sources - only when needed
data "aws_kms_key" "encryption_key" {
  count = var.enable_encryption ? 1 : 0
  key_id = "alias/${var.project_name}-${var.environment}"
}

# Lazy evaluation pattern
data "aws_ssm_parameter" "database_config" {
  count = var.external_database ? 1 : 0
  name  = "/infrastructure/${var.environment}/database/config"
}

locals {
  database_endpoint = var.external_database ? (
    jsondecode(data.aws_ssm_parameter.database_config[0].value).endpoint
  ) : aws_rds_instance.internal[0].endpoint
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>üîó Cross-Stack Data Integration</h4>
                            <div class="code-block-title">Remote State and SSM Integration</div>
                            <pre><code class="language-hcl"># Advanced remote state consumption
data "terraform_remote_state" "core_infrastructure" {
  backend = "s3"
  config = {
    bucket = "${var.organization}-terraform-state-${var.environment}"
    key    = "core/terraform.tfstate"
    region = var.aws_region
  }
}

data "terraform_remote_state" "security_baseline" {
  backend = "s3"
  config = {
    bucket = "${var.organization}-terraform-state-${var.environment}"
    key    = "security/terraform.tfstate"
    region = var.aws_region
  }
}

# SSM Parameter integration for dynamic configuration
data "aws_ssm_parameters_by_path" "application_config" {
  path      = "/applications/${var.application_name}/${var.environment}"
  recursive = true
}

locals {
  # Parse SSM parameters into usable configuration
  app_config = {
    for param in data.aws_ssm_parameters_by_path.application_config.names :
    replace(param, "/applications/${var.application_name}/${var.environment}/", "") => 
    data.aws_ssm_parameter.config_values[param].value
  }
}

data "aws_ssm_parameter" "config_values" {
  for_each = toset(data.aws_ssm_parameters_by_path.application_config.names)
  name     = each.value
}

# Cross-account resource discovery
data "aws_organizations_organization" "current" {
  count = var.multi_account_setup ? 1 : 0
}

data "aws_organizations_accounts" "all" {
  count = var.multi_account_setup ? 1 : 0
}

locals {
  # Account mapping for cross-account resources
  account_mapping = var.multi_account_setup ? {
    for account in data.aws_organizations_accounts.all[0].accounts :
    account.name => account.id
  } : {}
  
  # Environment-specific account IDs
  target_account_id = try(
    local.account_mapping["${var.environment}-account"],
    data.aws_caller_identity.current.account_id
  )
}</code></pre>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>Remote State Data Source</h3>
                    <pre><code class="language-hcl"># Reference another Terraform state
data "terraform_remote_state" "network" {
  backend = "s3"
  config = {
    bucket = "my-terraform-state"
    key    = "network/terraform.tfstate"
    region = "us-east-2"
  }
}

# Use remote state outputs
resource "aws_instance" "app" {
  ami                    = data.aws_ami.ubuntu.id
  instance_type          = var.instance_type
  subnet_id              = data.terraform_remote_state.network.outputs.private_subnet_ids[0]
  vpc_security_group_ids = [data.terraform_remote_state.network.outputs.app_security_group_id]
  
  tags = {
    Name = "app-server"
  }
}</code></pre>
                    <div class="info">
                        <strong>Best Practice:</strong> Structure your infrastructure into logical layers (network, security, compute) with separate state files.
                    </div>
                </section>

                <section>
                    <h3>Remote State Configuration</h3>
                    <pre><code class="language-hcl"># Backend configuration
terraform {
  backend "s3" {
    bucket         = "my-terraform-state"
    key            = "infrastructure/production/terraform.tfstate"
    region         = "us-east-2"
    encrypt        = true
    dynamodb_table = "terraform-state-lock"
  }
}</code></pre>
                    <div class="two-column">
                        <div class="column">
                            <h4>Benefits</h4>
                            <ul>
                                <li>Team collaboration</li>
                                <li>State locking</li>
                                <li>Backup and versioning</li>
                                <li>Security and encryption</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Configuration Options</h4>
                            <ul>
                                <li>S3 + DynamoDB (AWS)</li>
                                <li>Azure Storage</li>
                                <li>GCS (Google Cloud)</li>
                                <li>Consul (HashiCorp)</li>
                                <li>etcd (Kubernetes)</li>
                            </ul>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Lab 7 Callout -->
            <section class="lab-callout" data-background-color="#e83e8c">
                <div style="text-align: center; color: white;">
                    <h1><span class="emoji">üöÄ</span> Sophisticated Environment Management!</h1>
                    <h2><span class="emoji">‚öôÔ∏è</span> Lab 8: Multi-Environment Patterns</h2>
                    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin: 15px 0;">
                        <h3>üéØ What You'll Master:</h3>
                        <ul style="font-size: 1.0em; line-height: 1.4;">
                            <li>‚úÖ Sophisticated multi-environment architecture</li>
                            <li>‚úÖ Feature flags and cost optimization levels</li>
                            <li>‚úÖ Complex variable structures with validation</li>
                            <li>‚úÖ Automated environment validation scripts</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,193,7,0.2); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #ffc107;">
                        
                        <p style="font-size: 1.0em; margin: 8px 0 0 0;">Master enterprise environment patterns!</p>
                    </div>
                    <h2 style="margin-top: 20px; font-size: 1.8em;">üîß Advanced Environment Control!</h2>
                </div>
            </section>

            <!-- Section 4: Introduction to Modules -->
            <section>
                <section>
                    <h2>Section 4: Introduction to Terraform Modules</h2>
                </section>

                <section>
                    <h3>What are Terraform Modules?</h3>
                    <div class="success">
                        <strong>Modules</strong> are containers for multiple resources that are used together. They enable you to create reusable components and organize your Terraform code.
                    </div>
                    <h4>Benefits:</h4>
                    <ul>
                        <li><strong>Reusability:</strong> Use the same module across environments</li>
                        <li><strong>Organization:</strong> Logical grouping of resources</li>
                        <li><strong>Abstraction:</strong> Hide complexity behind clean interfaces</li>
                        <li><strong>Consistency:</strong> Standardize infrastructure patterns</li>
                        <li><strong>Testing:</strong> Test modules independently</li>
                    </ul>
                </section>

                <section>
                    <h3>Module Structure</h3>
                    <pre><code class="language-text">modules/
‚îú‚îÄ‚îÄ networking/
‚îÇ   ‚îú‚îÄ‚îÄ main.tf          # Primary resource definitions
‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # Input variable declarations
‚îÇ   ‚îú‚îÄ‚îÄ outputs.tf       # Output value declarations
‚îÇ   ‚îú‚îÄ‚îÄ versions.tf      # Provider requirements
‚îÇ   ‚îî‚îÄ‚îÄ README.md        # Module documentation
‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îú‚îÄ‚îÄ main.tf
‚îÇ   ‚îú‚îÄ‚îÄ variables.tf
‚îÇ   ‚îú‚îÄ‚îÄ outputs.tf
‚îÇ   ‚îî‚îÄ‚îÄ versions.tf
‚îî‚îÄ‚îÄ compute/
    ‚îú‚îÄ‚îÄ main.tf
    ‚îú‚îÄ‚îÄ variables.tf
    ‚îú‚îÄ‚îÄ outputs.tf
    ‚îî‚îÄ‚îÄ versions.tf</code></pre>
                </section>

                <section>
                    <h3>Creating a Simple Module</h3>
                    <h4>modules/networking/variables.tf</h4>
                    <pre><code class="language-hcl">variable "vpc_cidr" {
  description = "CIDR block for VPC"
  type        = string
  default     = "10.0.0.0/16"
}

variable "availability_zones" {
  description = "List of AZs to use"
  type        = list(string)
}

variable "environment" {
  description = "Environment name"
  type        = string
}

variable "tags" {
  description = "Common tags for all resources"
  type        = map(string)
  default     = {}
}</code></pre>
                </section>

                <section>
                    <h3>Module Main Configuration</h3>
                    <h4>modules/networking/main.tf</h4>
                    <pre><code class="language-hcl">resource "aws_vpc" "main" {
  cidr_block           = var.vpc_cidr
  enable_dns_hostnames = true
  enable_dns_support   = true
  
  tags = merge(var.tags, {
    Name = "${var.environment}-vpc"
  })
}

resource "aws_subnet" "private" {
  count = length(var.availability_zones)
  
  vpc_id            = aws_vpc.main.id
  cidr_block        = cidrsubnet(var.vpc_cidr, 8, count.index)
  availability_zone = var.availability_zones[count.index]
  
  tags = merge(var.tags, {
    Name = "${var.environment}-private-${count.index + 1}"
    Type = "private"
  })
}

resource "aws_internet_gateway" "main" {
  vpc_id = aws_vpc.main.id
  
  tags = merge(var.tags, {
    Name = "${var.environment}-igw"
  })
}</code></pre>
                </section>

                <section>
                    <h3>Module Outputs</h3>
                    <h4>modules/networking/outputs.tf</h4>
                    <pre><code class="language-hcl">output "vpc_id" {
  description = "ID of the VPC"
  value       = aws_vpc.main.id
}

output "vpc_cidr_block" {
  description = "CIDR block of the VPC"
  value       = aws_vpc.main.cidr_block
}

output "private_subnet_ids" {
  description = "List of private subnet IDs"
  value       = aws_subnet.private[*].id
}

output "internet_gateway_id" {
  description = "ID of the Internet Gateway"
  value       = aws_internet_gateway.main.id
}</code></pre>
                </section>

                <section>
                    <h3>Using Modules</h3>
                    <pre><code class="language-hcl">module "networking" {
  source = "./modules/networking"
  
  vpc_cidr           = "10.0.0.0/16"
  availability_zones = ["us-east-2a", "us-east-2b", "us-east-2c"]
  environment        = var.environment
  
  tags = {
    Environment = var.environment
    Project     = var.project_name
    ManagedBy   = "Terraform"
  }
}

# Reference module outputs
resource "aws_instance" "web" {
  ami       = data.aws_ami.ubuntu.id
  subnet_id = module.networking.private_subnet_ids[0]
  
  tags = {
    Name = "${var.environment}-web-server"
  }
}</code></pre>
                </section>

                <section>
                    <h3>Module Sources</h3>
                    <div class="two-column">
                        <div class="column">
                            <h4>Local Modules</h4>
                            <pre><code class="language-hcl">module "networking" {
  source = "./modules/networking"
}</code></pre>
                        </div>
                        <div class="column">
                            <h4>Remote Modules</h4>
                            <pre><code class="language-hcl"># Git repository
module "vpc" {
  source = "git::https://github.com/company/terraform-modules.git//networking?ref=v1.0.0"
}

# Terraform Registry
module "vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "~> 3.0"
}</code></pre>
                        </div>
                    </div>
                    <div class="highlight">
                        <strong>Best Practice:</strong> Always pin module versions in production to ensure consistency.
                    </div>
                </section>
            </section>

            <!-- Lab 8 Callout -->
            <section class="lab-callout" data-background-color="#20c997">
                <div style="text-align: center; color: white;">
                    <h1><span class="emoji">üåê</span> Networking Architecture Challenge!</h1>
                    <h2><span class="emoji">üèóÔ∏è</span> Lab 9: VPC Networking and Multi-Tier Architecture</h2>
                    <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <h3>üéØ What You'll Master:</h3>
                        <ul style="font-size: 1.1em; line-height: 1.6;">
                            <li>‚úÖ Design production-ready VPC with public, private, database subnets</li>
                            <li>‚úÖ Configure NAT Gateways, routing, and Application Load Balancer</li>
                            <li>‚úÖ Deploy multi-tier architecture across availability zones</li>
                            <li>‚úÖ Implement layered security with purpose-built security groups</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,193,7,0.2); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #ffc107;">
                        
                        <p style="font-size: 1.1em; margin: 10px 0 0 0;">Build enterprise networking architecture with high availability!</p>
                    </div>
                    <h2 style="margin-top: 30px; font-size: 2em;">üåä Complete Day 2 Mastery!</h2>
                </div>
            </section>

            <!-- Section 5: Error Handling and Debugging -->
            <section>
                <section>
                    <h2>Section 5: Error Handling and Debugging</h2>
                </section>

                <section>
                    <h3>Common Error Types</h3>
                    <div class="two-column">
                        <div class="column">
                            <h4>Syntax Errors</h4>
                            <ul>
                                <li>Invalid HCL syntax</li>
                                <li>Missing brackets/quotes</li>
                                <li>Incorrect block structure</li>
                            </ul>
                            <h4>Configuration Errors</h4>
                            <ul>
                                <li>Invalid resource arguments</li>
                                <li>Type mismatches</li>
                                <li>Circular dependencies</li>
                            </ul>
                        </div>
                        <div class="column">
                            <h4>Runtime Errors</h4>
                            <ul>
                                <li>API authentication issues</li>
                                <li>Resource conflicts</li>
                                <li>Quota limits</li>
                            </ul>
                            <h4>State Errors</h4>
                            <ul>
                                <li>State file corruption</li>
                                <li>Resource drift</li>
                                <li>State locking issues</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>Debugging Techniques</h3>
                    <pre><code class="language-bash"># Enable debug logging
export TF_LOG=DEBUG
export TF_LOG_PATH=terraform.log
terraform plan

# Validate configuration
terraform validate

# Check formatting
terraform fmt -check

# Detailed error output
terraform plan -detailed-exitcode

# Target specific resources
terraform plan -target=aws_instance.web</code></pre>
                </section>

                <section>
                    <h3>Error Prevention Strategies</h3>
                    <div class="info">
                        <h4>Validation Best Practices</h4>
                        <ul>
                            <li>Use variable validation rules</li>
                            <li>Implement provider version constraints</li>
                            <li>Add lifecycle rules for critical resources</li>
                            <li>Use data sources to verify external dependencies</li>
                        </ul>
                    </div>
                    <pre><code class="language-hcl">variable "environment" {
  description = "Environment name"
  type        = string
  
  validation {
    condition     = can(regex("^(dev|staging|prod)$", var.environment))
    error_message = "Environment must be dev, staging, or prod."
  }
}

# Check for existing resources before creating
data "aws_vpc" "existing" {
  count = var.create_vpc ? 0 : 1
  tags = {
    Name = "${var.environment}-vpc"
  }
}</code></pre>
                </section>
            </section>


            <!-- Best Practices -->
            <section>
                <section>
                    <h2>Terraform Best Practices</h2>
                </section>

                <section>
                    <h3>Code Organization</h3>
                    <div class="two-column">
                        <div class="column">
                            <h4>File Structure</h4>
                            <pre><code class="language-text">‚îú‚îÄ‚îÄ main.tf           # Primary resources
‚îú‚îÄ‚îÄ variables.tf      # Input variables
‚îú‚îÄ‚îÄ outputs.tf        # Output values
‚îú‚îÄ‚îÄ versions.tf       # Provider requirements
‚îú‚îÄ‚îÄ locals.tf         # Local values
‚îú‚îÄ‚îÄ data.tf           # Data sources
‚îú‚îÄ‚îÄ terraform.tfvars  # Variable values
‚îî‚îÄ‚îÄ modules/          # Custom modules</code></pre>
                        </div>
                        <div class="column">
                            <h4>Naming Conventions</h4>
                            <ul>
                                <li>Use descriptive resource names</li>
                                <li>Follow consistent patterns</li>
                                <li>Use underscores in identifiers</li>
                                <li>Prefix with resource type if helpful</li>
                            </ul>
                            <pre><code class="language-hcl"># Good
resource "aws_instance" "web_server" {
  # ...
}

# Better with context
resource "aws_instance" "web_server_primary" {
  # ...
}</code></pre>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>Version Management</h3>
                    <pre><code class="language-hcl">terraform {
  required_version = ">= 1.0"
  
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"  # Allow patch updates
    }
    random = {
      source  = "hashicorp/random"
      version = "3.4.3"   # Pin exact version for stability
    }
  }
}</code></pre>
                    <div class="highlight">
                        <strong>Best Practices:</strong>
                        <ul>
                            <li>Pin provider versions in production</li>
                            <li>Use version constraints appropriately</li>
                            <li>Test provider upgrades in staging first</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h3>Security Best Practices</h3>
                    <div class="danger">
                        <h4>Never commit sensitive data:</h4>
                        <ul>
                            <li>API keys or passwords in .tf files</li>
                            <li>terraform.tfvars with secrets</li>
                            <li>State files with sensitive outputs</li>
                        </ul>
                    </div>
                    <pre><code class="language-hcl"># Use AWS Secrets Manager
data "aws_secretsmanager_secret_version" "db_password" {
  secret_id = "database-password"
}

# Mark sensitive outputs
output "db_password" {
  value     = data.aws_secretsmanager_secret_version.db_password.secret_string
  sensitive = true
}

# Use environment variables
variable "api_key" {
  description = "API key (set via TF_VAR_api_key)"
  type        = string
  sensitive   = true
}</code></pre>
                </section>
            </section>

            <!-- Summary -->
            <section>
                <section>
                    <h2>Module 2 Summary</h2>
                    <h3>Key Takeaways</h3>
                    <ul>
                        <li><strong>Advanced Variables:</strong> Complex types, validation, and dynamic configuration</li>
                        <li><strong>Dependencies:</strong> Understanding implicit/explicit dependencies and lifecycle management</li>
                        <li><strong>Data Sources:</strong> Leverage existing resources and remote state</li>
                        <li><strong>Modules:</strong> Create reusable, maintainable infrastructure components</li>
                        <li><strong>Error Handling:</strong> Debug effectively and prevent common issues</li>
                        <li><strong>Best Practices:</strong> Organize code, manage versions, and maintain security</li>
                    </ul>
                </section>

                <section>
                    <h2>What's Next?</h2>
                    <h3>Module 3: Advanced Terraform Techniques</h3>
                    <ul>
                        <li>Multi-cloud and hybrid infrastructure</li>
                        <li>Advanced state management and workspaces</li>
                        <li>CI/CD integration and automation</li>
                        <li>Policy as code and governance</li>
                        <li>Performance optimization and scaling</li>
                    </ul>
                </section>

                <section>
                    <h2>Questions & Discussion</h2>
                    <div style="text-align: center; margin-top: 50px;">
                        <h3>Ready for the hands-on labs?</h3>
                        <p>Time to apply these concepts in our lab exercises!</p>
                    </div>
                </section>
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/notes/notes.min.js"></script>
    <script>
        Reveal.initialize({
            // Display configuration optimized for all screen sizes
            width: 1400,
            height: 800,
            margin: 0.03,

            // Scaling configuration for better visibility (increased zoom)
            minScale: 0.5,
            maxScale: 1.5,
            
            // Navigation and controls
            hash: true,
            controls: true,
            progress: true,
            center: false,
            touch: true,
            keyboard: true,
            overview: true,
            
            // Transitions
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            
            // Content handling
            embedded: false,
            autoSlide: 0,
            loop: false,
            shuffle: false,
            fragments: true,
            
            // Plugins
            plugins: [ RevealHighlight, RevealNotes ],
            
            // Code highlighting
            highlight: {
                highlightOnLoad: true,
                theme: 'monokai'
            },
            
            // Enhanced keyboard shortcuts
            keyboard: {
                13: 'next', // Enter key
                32: 'next', // Space key
                37: 'left', // Left arrow
                39: 'right', // Right arrow
                38: 'up',   // Up arrow
                40: 'down'  // Down arrow
            }
        });
    </script>
</body>
</html>